<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Glowy GO !</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; overflow: hidden; background: #f8f9fa; }
        #map { height: 100vh; width: 100vw; z-index: 1; }
        .top-ui { z-index: 1001 !important; }
        .bottom-ui { z-index: 2000 !important; }
        
        /* ç·Šæ¹Šå‹æ¨™ç±¤æ¨£å¼ */
        .facility-tag { padding: 6px 14px; font-size: 11px; }
        .tag-active { background-color: #FFBF00 !important; color: white !important; border-color: #FFBF00 !important; }

        /* è—è‰² GPS å®šä½çƒ */
        .user-location-dot { width: 16px; height: 16px; background: #3B82F6; border: 2px solid white; border-radius: 50%; box-shadow: 0 0 10px #3B82F6; }
        
        /* ç¶ è‰²æ´»å‹•å…‰æšˆ */
        .event-marker {
            width: 36px; height: 36px; background: #10B981; border: 2px solid white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 18px; 
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.5); cursor: pointer;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .drawer-hidden { transform: translateY(100%); }
    </style>
</head>
<body class="bg-gray-50">

    <div class="top-ui fixed top-3 left-0 right-0 px-4 flex flex-col gap-2">
        <div class="flex items-center gap-2">
            <div class="flex-grow bg-white/95 backdrop-blur h-11 rounded-full shadow-lg flex items-center px-4 gap-2 border border-gray-100">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke-width="3"></path></svg>
                <input type="text" placeholder="è¦å»å“ªè£¡ç©ï¼Ÿ" class="bg-transparent border-none focus:ring-0 text-xs w-full font-medium">
                <div id="weather" class="flex items-center gap-1 border-l pl-2 text-xs font-bold text-blue-500">
                    <span>12Â°C</span><span>â˜€ï¸</span>
                </div>
            </div>
            <div class="w-11 h-11 bg-white rounded-full shadow-lg border-2 border-white overflow-hidden">
                <img src="https://api.dicebear.com/7.x/adventurer/svg?seed=Lucky" class="w-full h-full">
            </div>
        </div>

        <div id="tag-bar" class="flex gap-1.5 overflow-x-auto no-scrollbar py-1">
            <button onclick="toggleTag('baby_care', this)" class="facility-tag flex-shrink-0 bg-white rounded-full shadow-sm font-black border border-amber-50 text-gray-700 transition-all">ğŸ¼ å“ºä¹³å®¤</button>
            <button onclick="toggleTag('toilets', this)" class="facility-tag flex-shrink-0 bg-white rounded-full shadow-sm font-black border border-amber-50 text-gray-700 transition-all">ğŸš¾ å…¬å»</button>
            <button onclick="toggleTag('drinking_water', this)" class="facility-tag flex-shrink-0 bg-white rounded-full shadow-sm font-black border border-amber-50 text-gray-700 transition-all">ğŸ’§ é£²æ°´æ©Ÿ</button>
        </div>

        <div class="flex justify-center">
            <button id="re-search-btn" onclick="refreshAllActiveTags()" class="hidden bg-white/90 backdrop-blur px-4 py-1.5 rounded-full shadow-md border border-gray-100 text-[10px] font-black text-gray-800 flex items-center gap-1">
                ğŸ”„ æœå°‹æ­¤å€åŸŸ
            </button>
        </div>
    </div>

    <div id="map"></div>

    <div id="drawer" class="bottom-ui fixed bottom-0 left-0 right-0 bg-white rounded-t-[32px] shadow-[0_-10px_40px_rgba(0,0,0,0.1)] px-6 pt-3 pb-8 transition-all duration-500 border-t border-gray-50">
        <div class="w-10 h
            

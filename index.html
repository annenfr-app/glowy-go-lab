<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>Glowy GO ! | å¸¶å¯¶å¯¶ä¹Ÿèƒ½å‡ºé–€å»ç©</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        :root { --amber: #FFBF00; --teal: #00838f; --soft-gray: #f8f9fa; --text: #3c4043; }
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; font-family: -apple-system, "Noto Sans TC", sans-serif; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; z-index: 1; background: var(--soft-gray); }

        /* ğŸŸ¢ é ‚éƒ¨ï¼šSNCF æœå°‹åˆ— + ç¨ç«‹é ­è²¼ */
        .header-ui { position: absolute; top: calc(env(safe-area-inset-top) + 12px); left: 12px; right: 12px; z-index: 1000; }
        .search-row { display: flex; gap: 10px; align-items: center; }
        .sncf-bar { 
            flex: 1; background: white; height: 50px; border-radius: 25px; 
            display: flex; align-items: center; padding: 0 18px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.12); cursor: pointer;
        }
        .profile-btn { 
            width: 50px; height: 50px; border-radius: 50%; background: white; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.12); overflow: hidden; border: 2px solid white; cursor: pointer;
        }

        /* ğŸŸ¢ ç¬¬äºŒæ’ï¼šè¨­æ–½åˆ†é¡æ¨™ç±¤ (å¤šé¸ã€é€æ˜å°é»ƒé») */
        .facility-tags { display: flex; gap: 8px; overflow-x: auto; margin-top: 12px; padding: 2px; }
        .facility-tags::-webkit-scrollbar { display: none; }
        .tag { 
            background: rgba(255, 255, 255, 0.9); padding: 7px 16px; border-radius: 20px; 
            font-size: 14px; white-space: nowrap; box-shadow: 0 2px 6px rgba(0,0,0,0.08); 
            border: 1px solid transparent; transition: 0.3s;
        }
        .tag.selected { border-color: var(--amber); background: #fffcf0; color: #b8860b; }

        /* ğŸŸ¢ å³å´å·¥å…·ï¼šåƒ… GPS å®šä½ */
        .gps-fab { 
            position: absolute; right: 16px; bottom: 180px; z-index: 1000; 
            width: 56px; height: 56px; border-radius: 28px; background: white; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.15); border: none; font-size: 26px; cursor: pointer;
        }

        /* ğŸŸ¢ æµ®å‹•æ³¡æ³¡ï¼šæ´»å‹•è³‡è¨Šèˆ‡æ¡é›†å¯¶ç‰© */
        .bubble { 
            position: absolute; bottom: 260px; left: 50%; transform: translateX(-50%);
            width: 88%; background: white; border-radius: 24px; padding: 20px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.2); z-index: 3000;
            display: none; animation: popUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popUp { from { bottom: 200px; opacity: 0; } to { bottom: 260px; opacity: 1; } }
        .bubble-actions { display: flex; gap: 12px; margin-top: 18px; }
        .btn-go { flex: 1; padding: 14px; border-radius: 12px; border: 1px solid #ddd; background: #fff; font-weight: 600; }
        .btn-collect { flex: 1; padding: 14px; border-radius: 12px; border: none; background: var(--amber); color: white; font-weight: bold; }

        /* ğŸŸ¢ åº•éƒ¨æŠ½å±œåˆ†é  */
        .bottom-nav { 
            position: fixed; bottom: 0; left: 0; right: 0; z-index: 2000; 
            background: white; border-top: 1px solid #eee; display: flex; 
            height: 75px; padding-bottom: env(safe-area-inset-bottom); 
        }
        .nav-tab { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #5f6368; font-size: 11px; }
        .nav-tab.active { color: var(--teal); font-weight: bold; }
        .nav-icon { font-size: 22px; margin-bottom: 4px; }
    </style>
</head>
<body>

    <div id="map"></div>

    <div class="header-ui">
        <div class="search-row">
            <div class="sncf-bar" onclick="openSNCF()">
                <span style="color:var(--teal); font-weight:bold; margin-right:10px;">G</span>
                <span style="color:#999;">æ‰¾æ´»å‹•ã€æ¡é›†ç”Ÿå‘½å¯¶ç‰©...</span>
            </div>
            <div class="profile-btn" onclick="openAccount()">
                <img src="https://api.dicebear.com/7.x/micah/svg?seed=Glowy" style="width:100%">
            </div>
        </div>
        <div class="facility-tags">
            <div class="tag" onclick="toggleTag(this)">ğŸ¼ å“ºä¹³å®¤</div>
            <div class="tag" onclick="toggleTag(this)">ğŸš» å…¬å»</div>
            <div class="tag" onclick="toggleTag(this)">ğŸ›— é›»æ¢¯</div>
            <div class="tag" onclick="toggleTag(this)">ğŸš° é£²æ°´æ©Ÿ</div>
            <div class="tag" onclick="toggleTag(this)">â™¿ å¡é“</div>
        </div>
    </div>

    <div class="bubble" id="actBubble">
        <div style="display:flex; justify-content:space-between;">
            <div id="bTitle" style="font-size:18px; font-weight:bold;">æ´»å‹•åç¨±</div>
            <div id="bWeather" style="color:#ff9800; font-size:12px; font-weight:bold;">ğŸŒ¡ï¸ 24Â°C æ™´</div>
        </div>
        <div id="bInfo" style="font-size:13px; color:#666; margin-top:6px;">é©åˆ 2-4 æ­² | èˆ‡å¯¶å¯¶ä¸€èµ·å‰µé€ ç”Ÿå‘½å²æ„Ÿ</div>
        <div class="bubble-actions">
            <button class="btn-go" onclick="launchNav()">ğŸš€ å‰å¾€å°èˆª</button>
            <button class="btn-collect" onclick="collectLifeHistory()">ğŸ’ æ¡é›†å¯¶ç‰©</button>
        </div>
    </div>

    <button class="gps-fab" onclick="map.locate({setView:true})">ğŸ¯</button>

    <nav class="bottom-nav">
        <div class="nav-tab active"><span class="nav-icon">ğŸ“</span>æ¢ç´¢</div>
        <div class="nav-tab"><span class="nav-icon">ğŸ›’</span>å‘¨é‚Šæ”¯æ´</div>
        <div class="nav-tab" onclick="giveContribution()"><span class="nav-icon">âœï¸</span>è²¢ç»</div>
        <div class="nav-tab"><span class="nav-icon">âš™ï¸</span>æœå‹™</div>
    </nav>

    <script>
        // åˆå§‹åŒ–åœ°åœ–
        const map = L.map('map', { zoomControl: false, attributionControl: false }).setView([25.0339, 121.5644], 14);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);

        // æ¨¡æ“¬æ•¸æ“šï¼šæ´»å‹•å¯¶ç‰© (ç¥ç€è‰²é»)
        const treasures = [
            { id: 101, name: "ä¿¡ç¾©è¦ªå­æ‰‹ä½œç‡Ÿ", lat: 25.035, lng: 121.567 },
            { id: 102, name: "å¤§å®‰æ£®æ—å…¬åœ’æ•…äº‹å±‹", lat: 25.031, lng: 121.535 }
        ];

        treasures.forEach(t => {
            L.circleMarker([t.lat, t.lng], {
                radius: 12, fillColor: '#FFBF00', color: '#fff', weight: 3, fillOpacity: 0.9
            }).addTo(map).on('click', (e) => {
                L.DomEvent.stopPropagation(e);
                showBubble(t);
            });
        });

        // ğŸŸ¢ é‚è¼¯ 1ï¼šSNCF æœå°‹æ¬¡é 
        function openSNCF() {
            alert("é€²å…¥ SNCF å¼æœå°‹æ¬¡é ï¼š\n1. å€åŸŸé¸æ“‡\n2. æ—¥æœŸæ™‚é–“æ®µ\n3. éš¨è¡Œè€…ï¼šç‰¹å®šå¯¶å¯¶ / è‡ªè¨‚éš¨è¡Œè€…å¹´é½¡");
        }

        // ğŸŸ¢ é‚è¼¯ 2ï¼šå€‹äººå¸³è™Ÿèˆ‡é›™è»Œé«”ç³»
        function openAccount() {
            alert("å¸³è™Ÿä¸­å¿ƒï¼š\nğŸ“¸ ç”Ÿå‘½å²æ„Ÿ (å·²æ¡é›†æ´»å‹•å²)\nğŸª™ å…¬ç›Šé»æ•¸ (ç´¯è¨ˆç¥ç€é»æ•¸)\nğŸ¼ éš¨è¡Œå¯¶å¯¶åå–®ç®¡ç†");
        }

        // ğŸŸ¢ é‚è¼¯ 3ï¼šæ¡é›†å¯¶ç‰© (ç”Ÿå‘½å²æ„Ÿ)
        function collectLifeHistory() {
            alert("é–‹å•Ÿç›¸æ©Ÿä¸­... ğŸ“¸\nè«‹æ‹æ”ç¾å ´ç…§ç‰‡æˆ–éŒ„å½±ä»¥å®Œæˆæ¡é›†ã€‚\né€™æ®µå›æ†¶å°‡å­˜å…¥æ‚¨èˆ‡å¯¶å¯¶çš„ã€ç”Ÿå‘½å²æ„Ÿã€‘ç´€éŒ„ä¸­ã€‚");
            document.getElementById('actBubble').style.display = 'none';
        }

        // ğŸŸ¢ é‚è¼¯ 4ï¼šè¨­æ–½è²¢ç» (å…¬ç›Šé»æ•¸)
        function giveContribution() {
            alert("æ„Ÿè¬å…¬ç›Šå›å ±ï¼\næå ±è¨­æ–½ç•°å‹•(å¦‚é›»æ¢¯ç¶­ä¿®)æˆåŠŸå¾Œï¼Œå°‡ç™¼æ”¾ã€ç¥ç€é»æ•¸ã€‘çå‹µã€‚");
        }

        function showBubble(t) {
            document.getElementById('bTitle').innerText = t.name;
            document.getElementById('actBubble').style.display = 'block';
            map.panTo([t.lat, t.lng]);
        }

        function toggleTag(el) { el.classList.toggle('selected'); }
        map.on('click', () => { document.getElementById('actBubble').style.display = 'none'; });
        function launchNav() { window.open("https://www.google.com/maps"); }
    </script>
</body>
</html>

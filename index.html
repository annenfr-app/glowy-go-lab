<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>Glowy GO !</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        :root { --amber: #FFBF00; --blue: #4285F4; --bg: #fdfaf5; }
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; font-family: -apple-system, sans-serif; }

        #map { position: absolute; top: 0; bottom: 0; width: 100%; z-index: 1; background: #e5e3df; }

        /* é ‚éƒ¨æœå°‹æ¢èˆ‡é ­è²¼ */
        .top-ui {
            position: absolute; top: 20px; left: 15px; right: 15px;
            z-index: 1000; display: flex; flex-direction: column; gap: 10px;
        }
        .search-row { display: flex; gap: 10px; align-items: center; }
        .search-bar {
            flex: 1; background: white; height: 50px; border-radius: 25px;
            display: flex; align-items: center; padding: 0 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15); font-size: 16px; color: #999;
        }
        .user-avatar {
            width: 50px; height: 50px; border-radius: 25px; background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15); overflow: hidden; border: 2px solid white; cursor: pointer;
        }

        /* Tags æ©«å‘æ²å‹• */
        .tags-row { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 5px; -webkit-overflow-scrolling: touch; }
        .tags-row::-webkit-scrollbar { display: none; }
        .tag {
            background: white; padding: 8px 18px; border-radius: 20px;
            white-space: nowrap; font-size: 13px; font-weight: 500;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); border: 1px solid #f0f0f0;
        }

        /* åº•éƒ¨å°è¦½åˆ— */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; right: 0; height: 80px;
            background: white; z-index: 2000; display: flex;
            justify-content: space-around; align-items: center;
            border-top: 1px solid #eee; padding-bottom: env(safe-area-inset-bottom);
        }
        .nav-item { text-align: center; color: #999; font-size: 11px; flex: 1; }
        .nav-item.active { color: var(--amber); }
        .nav-icon { font-size: 22px; margin-bottom: 3px; }

        /* GPS æŒ‰éˆ• - å¢åŠ è¦–è¦ºå›é¥‹ */
        .gps-btn {
            position: absolute; bottom: 100px; right: 20px; z-index: 1000;
            background: white; width: 52px; height: 52px; border-radius: 26px;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); font-size: 24px;
            cursor: pointer; border: none; transition: transform 0.1s, background 0.1s;
        }
        .gps-btn:active { transform: scale(0.9); background: #f8f8f8; }
    </style>
</head>
<body>

    <div id="map"></div>

    <div class="top-ui">
        <div class="search-row">
            <div class="search-bar">ğŸ” æœå°‹æ´»å‹•ã€è¨­æ–½...</div>
            <div class="user-avatar" onclick="alert('é€²å…¥æœƒå“¡ä¸­å¿ƒï¼šè³‡æ–™ã€ç©é»ã€å€‹äººè¨­å®š')">
                <img src="https://api.dicebear.com/7.x/micah/svg?seed=Glowy" style="width:100%">
            </div>
        </div>
        <div class="tags-row">
            <div class="tag">ğŸ¼ å“ºä¹³å®¤</div>
            <div class="tag">ğŸ¡ æŠ“å¯¶æ´»å‹•</div>
            <div class="tag">â˜• è¦ªå­å‹å–„</div>
            <div class="tag">ğŸ’ æ‰˜è‚²è¨­æ–½</div>
        </div>
    </div>

    <button class="gps-btn" onclick="triggerGPS()">ğŸ¯</button>

    <div class="bottom-nav">
        <div class="nav-item active"><div class="nav-icon">ğŸ—ºï¸</div>åœ°åœ–</div>
        <div class="nav-item"><div class="nav-icon">âœï¸</div>è²¢ç»</div>
        <div class="nav-item"><div class="nav-icon">ğŸ“¸</div>å¯«çœŸé›†</div>
        <div class="nav-item"><div class="nav-icon">ğŸ—‚ï¸</div>å¡åŒ…</div>
    </div>

    <script>
        // åˆå§‹åŒ–åœ°åœ–
        const map = L.map('map', { zoomControl: false, attributionControl: false }).setView([25.0339, 121.5644], 16);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        // 1. è¼‰å…¥ç¥ç€å‹å–„è¨­æ–½ï¼ˆå°é»ƒé»ï¼‰
        const facilities = [
            { name: "å¿ å­æ–°ç”Ÿå‹å–„å“ºä¹³å®¤", lat: 25.0422, lng: 121.5328 },
            { name: "ä¿¡ç¾©å€è¦ªå­æ€¥æ•‘ç®±é»ä½", lat: 25.0345, lng: 121.5655 },
            { name: "åœ‹çˆ¶ç´€å¿µé¤¨æŠ“å¯¶æ´»å‹•é»", lat: 25.0394, lng: 121.5592 }
        ];

        facilities.forEach(loc => {
            L.circleMarker([loc.lat, loc.lng], {
                radius: 8,
                fillColor: "#FFBF00",
                color: "white",
                weight: 2,
                opacity: 1,
                fillOpacity: 0.9
            }).addTo(map).bindPopup(`<b>${loc.name}</b>`);
        });

        // 2. å®šä½é‚è¼¯
        let userMarker, accuracyCircle;

        function triggerGPS() {
            console.log("æ­£åœ¨è§¸ç™¼å®šä½...");
            map.locate({setView: true, maxZoom: 16, enableHighAccuracy: true});
        }

        map.on('locationfound', function(e) {
            if (userMarker) map.removeLayer(userMarker);
            if (accuracyCircle) map.removeLayer(accuracyCircle);

            // ç¹ªè£½ç”¨æˆ¶ç•¶å‰ä½ç½®ï¼ˆè—è‰²é»ï¼‰
            userMarker = L.circleMarker(e.latlng, {
                radius: 9, fillColor: "#4285F4", color: "white", weight: 3, opacity: 1, fillOpacity: 1
            }).addTo(map);

            accuracyCircle = L.circle(e.latlng, e.accuracy / 2, {
                color: "#4285F4", weight: 1, fillOpacity: 0.1
            }).addTo(map);
        });

        map.on('locationerror', function(e) {
            console.log("å®šä½å¤±æ•—ï¼Œéœé»˜è™•ç†ã€‚");
        });

        // åˆå§‹å•Ÿå‹•è‡ªå‹•å®šä½ä¸€æ¬¡ï¼ˆä¾æ“šå…¨æ›¸è¦ç¯„ï¼‰
        window.onload = triggerGPS;
    </script>
</body>
</html>
